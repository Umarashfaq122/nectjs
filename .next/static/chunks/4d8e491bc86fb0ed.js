(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72905,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(27341),r=e.i(70065),l=e.i(67881),i=e.i(23750),n=e.i(94179),d=e.i(69035),c=e.i(10708),m=e.i(30374),x=e.i(62870),o=e.i(46897),h=e.i(87316),g=e.i(46948),j=e.i(31674),u=e.i(69638);let p=(0,e.i(75254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var N=e.i(63059),f=e.i(86536),b=e.i(97548),v=e.i(55436),w=e.i(40160),y=e.i(17923),_=e.i(50439),C=e.i(63209),S=e.i(88844),T=e.i(3116),k=e.i(71428);function L(){let[e,L]=(0,a.useState)([]),[A,B]=(0,a.useState)([]),[F,D]=(0,a.useState)(null),[z,P]=(0,a.useState)(!1),[E,R]=(0,a.useState)(!0),[H,$]=(0,a.useState)(null),[I,W]=(0,a.useState)(""),[Y,O]=(0,a.useState)("all"),[M,V]=(0,a.useState)("all"),[U,G]=(0,a.useState)(1),[q,K]=(0,a.useState)(!1),Z=e.length,X=e.filter(e=>e.land_prepared).length,J=e.filter(e=>!e.land_prepared).length,Q=[...new Set(e.map(e=>e.field))].length,ee=Array.from(new Map(e.map(e=>[e.field,{id:e.field,field_name:e.field_name}])).values());(0,a.useEffect)(()=>{es()},[]),(0,a.useEffect)(()=>{let s=[...e];if(""!==I.trim()){let e=I.toLowerCase();s=s.filter(s=>s.crop_name.toLowerCase().includes(e)||s.organic_amendments_used.toLowerCase().includes(e)||s.methods_used.toLowerCase().includes(e))}if("all"!==Y){let e=parseInt(Y);s=s.filter(s=>s.field===e)}"prepared"===M?s=s.filter(e=>e.land_prepared):"not-prepared"===M?s=s.filter(e=>!e.land_prepared):"burnt"===M?s=s.filter(e=>"burnt"===e.residue_management):"incorporated"===M&&(s=s.filter(e=>"incorporated"===e.residue_management)),B(s)},[I,Y,M,e]);let es=async()=>{try{R(!0);let e=localStorage.getItem("authToken");if(!e)return void $("No authentication token found");let s=await fetch("https://rda.ngrok.app/api/land-preparations/",{headers:{Authorization:`Bearer ${e}`,"ngrok-skip-browser-warning":"true"}});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);let a=await s.json();console.log("Fetched land preparation data:",a),L(a.results||[]),B(a.results||[]),K(!!a.next)}catch(e){$(e instanceof Error?e.message:"Failed to fetch data"),console.error("Error fetching land preparation data:",e)}finally{R(!1)}},ea=async()=>{try{let e=localStorage.getItem("authToken");if(!e||!q)return;let s=await fetch(`https://rda.ngrok.app/api/land-preparations/?page=${U+1}`,{headers:{Authorization:`Bearer ${e}`,"ngrok-skip-browser-warning":"true"}});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);let a=await s.json();L(e=>[...e,...a.results||[]]),B(e=>[...e,...a.results||[]]),K(!!a.next),G(e=>e+1)}catch(e){console.error("Error loading more data:",e)}},et=e=>e?"bg-green-100 text-green-800":"bg-red-100 text-red-800",er=e=>{switch(e?.toLowerCase()){case"burnt":return"bg-orange-100 text-orange-800";case"incorporated":return"bg-green-100 text-green-800";case"removed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},el=e=>e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Not specified",ei=e=>e.includes("[object Object]")?"Various methods":e.split(",").map(e=>e.trim()).filter(Boolean),en=e=>e.includes("[object Object]")?"Various organic amendments":e.split(",").map(e=>e.trim()).filter(Boolean);return E?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(k.Skeleton,{className:"h-10 w-48"}),(0,s.jsx)(k.Skeleton,{className:"h-4 w-64 mt-2"})]}),(0,s.jsx)(k.Skeleton,{className:"h-10 w-32"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,s.jsx)(k.Skeleton,{className:"h-32 rounded-lg"},e))}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,s.jsx)(k.Skeleton,{className:"h-64 rounded-lg"},e))})]}):H?(0,s.jsx)(r.Card,{children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center py-8 text-red-500",children:[(0,s.jsx)(C.AlertCircle,{className:"h-12 w-12 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:"Error Loading Data"}),(0,s.jsx)("p",{className:"text-sm mt-2",children:H}),(0,s.jsx)(l.Button,{onClick:es,className:"mt-4",children:"Retry"})]})})}):(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Land Preparation Records"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Track land preparation activities, methods used, and residue management"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(w.Download,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,s.jsxs)(l.Button,{size:"sm",onClick:es,children:[(0,s.jsx)(y.BarChart3,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-amber-700",children:"Total Records"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-amber-900 mt-2",children:Z})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-amber-200 flex items-center justify-center",children:(0,s.jsx)(o.MapPin,{className:"h-6 w-6 text-amber-700"})})]})})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-green-700",children:"Land Prepared"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-green-900 mt-2",children:X})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-green-200 flex items-center justify-center",children:(0,s.jsx)(u.CheckCircle,{className:"h-6 w-6 text-green-700"})})]}),(0,s.jsxs)("p",{className:"text-xs text-green-600 mt-2",children:[Z>0?(X/Z*100).toFixed(1):0,"% of total"]})]})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-red-700",children:"Not Prepared"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-red-900 mt-2",children:J})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-red-200 flex items-center justify-center",children:(0,s.jsx)(p,{className:"h-6 w-6 text-red-700"})})]})})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-700",children:"Active Fields"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-blue-900 mt-2",children:Q})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-blue-200 flex items-center justify-center",children:(0,s.jsx)(g.Sprout,{className:"h-6 w-6 text-blue-700"})})]})})})]}),(0,s.jsx)(r.Card,{children:(0,s.jsx)(r.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[(0,s.jsx)("div",{className:"flex-1 w-full lg:w-auto",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(v.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,s.jsx)(i.Input,{placeholder:"Search by crop name, organic amendments, or methods...",value:I,onChange:e=>W(e.target.value),className:"pl-10 w-full lg:w-[400px]"})]})}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(b.Filter,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)(x.Select,{value:Y,onValueChange:O,children:[(0,s.jsx)(x.SelectTrigger,{className:"w-[180px]",children:(0,s.jsx)(x.SelectValue,{placeholder:"Filter by field"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"all",children:"All Fields"}),ee.map(e=>(0,s.jsx)(x.SelectItem,{value:e.id.toString(),className:"capitalize",children:e.field_name},e.id))]})]})]}),(0,s.jsx)(t.Tabs,{value:M,onValueChange:V,className:"w-auto",children:(0,s.jsxs)(t.TabsList,{children:[(0,s.jsx)(t.TabsTrigger,{value:"all",children:"All"}),(0,s.jsx)(t.TabsTrigger,{value:"prepared",children:"Prepared"}),(0,s.jsx)(t.TabsTrigger,{value:"not-prepared",children:"Not Prepared"}),(0,s.jsx)(t.TabsTrigger,{value:"burnt",children:"Burnt Residue"})]})})]})]})})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold",children:["Land Preparation Records",(0,s.jsxs)("span",{className:"text-muted-foreground font-normal ml-2",children:["(",A.length," ",1===A.length?"record":"records",")"]})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sorted by latest preparation date"})]}),0===A.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-12 text-center",children:[(0,s.jsx)(o.MapPin,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No land preparation data found"}),(0,s.jsx)("p",{className:"text-gray-500 max-w-sm mx-auto",children:I?"No records match your search criteria. Try different keywords.":"No land preparation data has been recorded yet."})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(e=>{let a=ei(e.methods_used),t=en(e.organic_amendments_used);return(0,s.jsx)(r.Card,{className:"group hover:shadow-lg transition-all duration-300 hover:border-primary/30 overflow-hidden",children:(0,s.jsxs)(r.CardContent,{className:"p-0",children:[(0,s.jsx)("div",{className:e.land_prepared?"bg-gradient-to-r from-amber-50 to-amber-100 p-5":"bg-gradient-to-r from-red-50 to-red-100 p-5",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 line-clamp-1 capitalize",children:e.crop_name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Record #",e.id," •",e.field_name]})]}),(0,s.jsx)(n.Badge,{className:et(e.land_prepared),children:e.land_prepared?"Prepared":"Not Prepared"})]})}),(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(h.Calendar,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"Preparation Date"})]}),(0,s.jsx)("span",{className:"font-medium",children:el(e.preparation_date)})]}),e.land_prepared?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm font-medium text-gray-700 mb-2",children:"Organic Amendments"}),(0,s.jsx)("div",{className:"bg-green-50 p-3 rounded-lg",children:Array.isArray(t)?(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map((e,a)=>(0,s.jsx)(n.Badge,{variant:"outline",className:"bg-white",children:e},a))}):(0,s.jsx)("span",{className:"text-sm",children:t})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(j.Leaf,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"Residue Management"})]}),(0,s.jsx)(n.Badge,{className:er(e.residue_management),children:e.residue_management_display||"Not specified"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm font-medium text-gray-700 mb-2",children:"Methods Used"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:Array.isArray(a)?(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:a.map((e,a)=>(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:e},a))}):(0,s.jsx)("span",{className:"text-sm",children:a})})]}),e.expected_sowing_date&&(0,s.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-blue-800 mb-1 flex items-center gap-1",children:[(0,s.jsx)(T.Clock,{className:"h-4 w-4"}),"Expected Sowing Date"]}),(0,s.jsx)("p",{className:"text-sm text-blue-700",children:el(e.expected_sowing_date)})]})]}):(0,s.jsxs)("div",{className:"mt-4 p-3 bg-red-50 rounded-lg border border-red-200",children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-red-800 mb-1 flex items-center gap-1",children:[(0,s.jsx)(C.AlertCircle,{className:"h-4 w-4"}),"Reason Not Prepared"]}),(0,s.jsx)("p",{className:"text-sm text-red-700",children:e.reason_not_prepared||"No reason provided"})]})]}),(0,s.jsxs)(l.Button,{onClick:()=>{D(e),P(!0)},variant:"outline",className:"w-full mt-4 gap-2 group-hover:border-primary",children:[(0,s.jsx)(f.Eye,{className:"h-4 w-4"}),"View Full Details",(0,s.jsx)(N.ChevronRight,{className:"h-4 w-4"})]})]}),(0,s.jsx)(r.CardFooter,{className:"border-t pt-4 flex justify-between text-sm text-gray-500",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:`w-2 h-2 rounded-full ${e.land_prepared?"bg-amber-500":"bg-red-500"}`}),(0,s.jsxs)("span",{children:["Field ",e.field]})]})})]})},e.id)})}),q&&(0,s.jsx)("div",{className:"mt-8 text-center",children:(0,s.jsx)(l.Button,{variant:"outline",onClick:ea,children:"Load More Records"})})]})]}),(0,s.jsx)(m.Dialog,{open:z,onOpenChange:P,children:(0,s.jsx)(m.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:(()=>{if(!F)return null;let e=ei(F.methods_used),a=en(F.organic_amendments_used);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.DialogHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(m.DialogTitle,{className:"text-2xl flex items-center gap-2",children:[(0,s.jsx)(o.MapPin,{className:"h-6 w-6 text-primary"}),"Land Preparation #",F.id]}),(0,s.jsxs)(m.DialogDescription,{children:["Complete land preparation details • Field ",F.field]})]}),(0,s.jsx)(n.Badge,{className:et(F.land_prepared),children:F.land_prepared?"Prepared":"Not Prepared"})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(_.Wheat,{className:"h-5 w-5 text-green-600"}),"Crop & Field Details"]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Crop Name"}),(0,s.jsx)("p",{className:"font-medium capitalize",children:F.crop_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Field"}),(0,s.jsxs)("p",{className:"font-medium",children:["Field ",F.field]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Field Name"}),(0,s.jsx)("p",{className:"font-medium",children:F.field_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Land Prepared"}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:F.land_prepared?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.CheckCircle,{className:"h-4 w-4 text-green-500"}),(0,s.jsx)("span",{className:"text-green-600 font-medium",children:"Yes"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p,{className:"h-4 w-4 text-red-500"}),(0,s.jsx)("span",{className:"text-red-600",children:"No"})]})})]})]}),(0,s.jsx)(d.Separator,{}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground mb-2",children:"Preparation Date"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg flex items-center gap-2",children:[(0,s.jsx)(h.Calendar,{className:"h-4 w-4 text-gray-500"}),(0,s.jsx)("span",{className:"font-medium",children:el(F.preparation_date)})]})]})]})]}),F.land_prepared?(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(S.Package,{className:"h-5 w-5 text-amber-600"}),"Preparation Methods"]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Methods Used"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:Array.isArray(e)&&e.length>0?(0,s.jsx)("div",{className:"space-y-2",children:e.map((e,a)=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,s.jsx)("span",{className:"text-sm",children:e})]},a))}):(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"No methods specified"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Organic Amendments"}),(0,s.jsx)("div",{className:"bg-green-50 p-3 rounded-lg",children:Array.isArray(a)&&a.length>0?(0,s.jsx)("div",{className:"space-y-2",children:a.map((e,a)=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"}),(0,s.jsx)("span",{className:"text-sm",children:e})]},a))}):(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"No organic amendments specified"})})]})]})]}):(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(C.AlertCircle,{className:"h-5 w-5 text-red-600"}),"Reason Not Prepared"]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsx)("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(C.AlertCircle,{className:"h-6 w-6 text-red-600 mt-1"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-red-800 mb-1",children:"Reason for Not Preparing Land"}),(0,s.jsx)("p",{className:"text-red-700",children:F.reason_not_prepared||"No reason provided"})]})]})})})]})]}),F.land_prepared&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(j.Leaf,{className:"h-5 w-5 text-blue-600"}),"Residue Management"]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Management Method"}),(0,s.jsx)("div",{className:`p-3 rounded-lg ${er(F.residue_management)}`,children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-medium",children:F.residue_management_display||"Not specified"}),(0,s.jsx)(n.Badge,{variant:"outline",className:"bg-white",children:F.residue_management||"N/A"})]})})]})})})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(h.Calendar,{className:"h-5 w-5 text-purple-600"}),"Sowing Schedule"]})}),(0,s.jsx)(r.CardContent,{children:F.expected_sowing_date?(0,s.jsx)("div",{className:"space-y-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Expected Sowing Date"}),(0,s.jsx)("div",{className:"bg-purple-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.Calendar,{className:"h-4 w-4 text-purple-600"}),(0,s.jsx)("span",{className:"font-medium",children:el(F.expected_sowing_date)})]})})]})}):(0,s.jsx)("div",{className:"text-center py-4 text-gray-500",children:"No sowing date specified"})})]})]})}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(T.Clock,{className:"h-5 w-5 text-gray-600"}),"Timeline Information"]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Record Created"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.Calendar,{className:"h-4 w-4 text-gray-500"}),(0,s.jsx)("span",{children:el(F.created_at)})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Record ID"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"font-medium",children:["#",F.id]}),(0,s.jsx)(n.Badge,{variant:"outline",children:"Land Prep"})]})})]})]})})]}),(0,s.jsxs)(m.DialogFooter,{children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>P(!1),children:"Close"}),(0,s.jsx)(l.Button,{children:"Export Report"})]})]})]})})()})})]})}function A(){let[e,x]=(0,a.useState)([]),[o,h]=(0,a.useState)([]),[g,j]=(0,a.useState)(null),[u,p]=(0,a.useState)(!0),[N,b]=(0,a.useState)(null),[v,w]=(0,a.useState)(""),[y,_]=(0,a.useState)("all"),[S,T]=(0,a.useState)("all"),[L,A]=(0,a.useState)(!1);(0,a.useEffect)(()=>{B()},[]);let B=async()=>{try{let e=localStorage.getItem("authToken");if(!e)return;p(!0);let s=await fetch("https://rda.ngrok.app/api/sowing-emergence-stageView/",{headers:{Authorization:`Bearer ${e}`,"ngrok-skip-browser-warning":"true"}});if(!s.ok)throw Error(`HTTP ${s.status}`);let a=((await s.json()).results||[]).map(e=>({...e,germination_issues:e.germination_issues??{}}));x(a),h(a)}catch(e){b(e instanceof Error?e.message:"Failed to load data")}finally{p(!1)}};return((0,a.useEffect)(()=>{let s=[...e];if(v.trim()){let e=v.toLowerCase();s=s.filter(s=>s.crop_name.toLowerCase().includes(e)||s.variety.toLowerCase().includes(e)||s.method_of_sowing.toLowerCase().includes(e)||s.farm.toString().includes(e))}"all"!==S&&(s=s.filter(e=>e.farm.toString()===S)),"issues"===y?s=s.filter(e=>Object.keys(e.germination_issues??{}).length>0):"all"!==y&&(s=s.filter(e=>e.germination_percentage.toLowerCase()===y)),h(s)},[e,v,y,S]),u)?(0,s.jsx)(k.Skeleton,{className:"h-64 w-full"}):N?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-10 text-center text-red-600",children:[(0,s.jsx)(C.AlertCircle,{className:"mx-auto mb-4"}),(0,s.jsx)("p",{children:N}),(0,s.jsx)(l.Button,{className:"mt-4",onClick:B,children:"Retry"})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold",children:"Sowing & Emergence Data"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(i.Input,{placeholder:"Search farms…",value:v,onChange:e=>w(e.target.value)}),(0,s.jsx)(t.Tabs,{value:y,onValueChange:e=>_(e),children:(0,s.jsxs)(t.TabsList,{children:[(0,s.jsx)(t.TabsTrigger,{value:"all",children:"All"}),(0,s.jsx)(t.TabsTrigger,{value:"good",children:"Good"}),(0,s.jsx)(t.TabsTrigger,{value:"average",children:"Average"}),(0,s.jsx)(t.TabsTrigger,{value:"poor",children:"Poor"}),(0,s.jsx)(t.TabsTrigger,{value:"issues",children:"Issues"})]})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(e=>{var a;return(0,s.jsx)(r.Card,{className:"hover:shadow-lg transition",children:(0,s.jsxs)(r.CardContent,{className:"p-5 space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("h3",{className:"font-semibold",children:e.crop_name}),(0,s.jsx)(n.Badge,{className:"Good"===(a=e.germination_percentage)?"bg-green-100 text-green-800":"Average"===a?"bg-yellow-100 text-yellow-800":"Poor"===a?"bg-red-100 text-red-800":"bg-gray-100",children:e.germination_percentage})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Farm #",e.farm," • ",e.farm_name]}),(0,s.jsx)(d.Separator,{}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Sowing Date"}),(0,s.jsx)("span",{children:new Date(e.raya_sowing_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),(0,s.jsxs)(l.Button,{variant:"outline",className:"w-full",onClick:()=>{j(e),A(!0)},children:[(0,s.jsx)(f.Eye,{className:"mr-2 h-4 w-4"})," View Details"]})]})},e.id)})}),(0,s.jsx)(m.Dialog,{open:L,onOpenChange:A,children:(0,s.jsx)(m.DialogContent,{className:"max-w-3xl",children:g&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(m.DialogHeader,{children:[(0,s.jsx)(m.DialogTitle,{children:g.crop_name}),(0,s.jsxs)(m.DialogDescription,{children:[g.farm_name," • Farmer: ",g.farmer_name]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"Germination Issues"})}),(0,s.jsx)(r.CardContent,{children:Object.keys(g.germination_issues??{}).length>0?Object.entries(g.germination_issues??{}).map(([e,a])=>(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)(c.Label,{children:e}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:(a??[]).map((e,a)=>(0,s.jsx)(n.Badge,{variant:"outline",children:e},a))})]},e)):(0,s.jsx)("p",{className:"text-muted-foreground",children:"No issues reported"})})]}),(0,s.jsx)(m.DialogFooter,{children:(0,s.jsx)(l.Button,{onClick:()=>A(!1),children:"Close"})})]})})})]})}var B=e.i(10289);function F(){let[e,o]=(0,a.useState)([]),[T,L]=(0,a.useState)([]),[A,F]=(0,a.useState)(null),[D,z]=(0,a.useState)(!1),[P,E]=(0,a.useState)(!0),[R,H]=(0,a.useState)(null),[$,I]=(0,a.useState)(""),[W,Y]=(0,a.useState)("all"),[O,M]=(0,a.useState)("all"),V=e.length,U=e.filter(e=>"Healthy"===e.crop_health||"healthy"===e.crop_health).length,G=e.filter(e=>e.weeds_present).length,q=e.filter(e=>"Yes"===e.yellowing_observed).length,K=Array.from(new Set(e.map(e=>e.crop_name))).map(e=>({id:e,name:e}));(0,a.useEffect)(()=>{Z()},[]),(0,a.useEffect)(()=>{let s=[...e];if(""!==$.trim()){let e=$.toLowerCase();s=s.filter(s=>s.crop_name.toLowerCase().includes(e)||s.fertilizer_type.toLowerCase().includes(e)||s.bio_stimulant_product.toLowerCase().includes(e))}"all"!==W&&(s=s.filter(e=>e.crop_name===W)),"issues"===O?s=s.filter(e=>"Yes"===e.yellowing_observed||e.weeds_present):"healthy"===O?s=s.filter(e=>"Healthy"===e.crop_health||"healthy"===e.crop_health):"yellowing"===O&&(s=s.filter(e=>"Yes"===e.yellowing_observed)),L(s)},[$,W,O,e]);let Z=async()=>{try{E(!0);let e=localStorage.getItem("authToken");if(!e)return void H("No authentication token found");let s=await fetch("https://rda.ngrok.app/api/growth-tillering/",{headers:{Authorization:`Bearer ${e}`,"ngrok-skip-browser-warning":"true"}});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);let a=await s.json();console.log("Fetched growth & tillering data:",a),o(a||[]),L(a||[])}catch(e){H(e instanceof Error?e.message:"Failed to fetch data"),console.error("Error fetching growth & tillering data:",e)}finally{E(!1)}},X=e=>{switch(e.toLowerCase()){case"healthy":return"bg-green-100 text-green-800";case"fair":return"bg-yellow-100 text-yellow-800";case"stressed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},J=e=>e.includes("<")||e.includes("less")?"text-blue-600":e.includes("6-12")?"text-green-600":"text-amber-600",Q=e=>e.includes("less_than_6_inches")||"<6"===e?"Less than 6 inches":e,ee=e=>"Yes"===e?"bg-red-100 text-red-800":"bg-green-100 text-green-800",es=e=>"Yes"===e?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",ea=e=>(0,s.jsx)("div",{className:"flex items-center gap-1",children:"Yes"===e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.CheckCircle,{className:"h-4 w-4 text-green-500"}),(0,s.jsx)("span",{className:"text-green-600 font-medium",children:"Yes"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p,{className:"h-4 w-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-gray-500",children:"No"})]})}),et=e=>(0,s.jsx)("div",{className:"flex items-center gap-1",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.CheckCircle,{className:"h-4 w-4 text-green-500"}),(0,s.jsx)("span",{className:"text-green-600 font-medium",children:"Yes"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p,{className:"h-4 w-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-gray-500",children:"No"})]})});return P?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(k.Skeleton,{className:"h-10 w-48"}),(0,s.jsx)(k.Skeleton,{className:"h-4 w-64 mt-2"})]}),(0,s.jsx)(k.Skeleton,{className:"h-10 w-32"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,s.jsx)(k.Skeleton,{className:"h-32 rounded-lg"},e))}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,s.jsx)(k.Skeleton,{className:"h-64 rounded-lg"},e))})]}):R?(0,s.jsx)(r.Card,{children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center py-8 text-red-500",children:[(0,s.jsx)(C.AlertCircle,{className:"h-12 w-12 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:"Error Loading Data"}),(0,s.jsx)("p",{className:"text-sm mt-2",children:R}),(0,s.jsx)(l.Button,{onClick:Z,className:"mt-4",children:"Retry"})]})})}):(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Growth & Tillering Stage"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Monitor crop development, fertilizer applications, and pest management"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(w.Download,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,s.jsxs)(l.Button,{size:"sm",onClick:Z,children:[(0,s.jsx)(y.BarChart3,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-green-700",children:"Total Records"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-green-900 mt-2",children:V})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-green-200 flex items-center justify-center",children:(0,s.jsx)(g.Sprout,{className:"h-6 w-6 text-green-700"})})]})})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-700",children:"Healthy Crops"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-blue-900 mt-2",children:U})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-blue-200 flex items-center justify-center",children:(0,s.jsx)(u.CheckCircle,{className:"h-6 w-6 text-blue-700"})})]}),(0,s.jsxs)("p",{className:"text-xs text-blue-600 mt-2",children:[V>0?(U/V*100).toFixed(1):0,"% of total"]})]})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-red-700",children:"Weeds Present"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-red-900 mt-2",children:G})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-red-200 flex items-center justify-center",children:(0,s.jsx)(j.Leaf,{className:"h-6 w-6 text-red-700"})})]})})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-amber-700",children:"Yellowing Observed"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-amber-900 mt-2",children:q})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-amber-200 flex items-center justify-center",children:(0,s.jsx)(C.AlertCircle,{className:"h-6 w-6 text-amber-700"})})]})})})]}),(0,s.jsx)(r.Card,{children:(0,s.jsx)(r.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[(0,s.jsx)("div",{className:"flex-1 w-full lg:w-auto",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(v.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,s.jsx)(i.Input,{placeholder:"Search by crop name, fertilizer type, or bio stimulant...",value:$,onChange:e=>I(e.target.value),className:"pl-10 w-full lg:w-[400px]"})]})}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(b.Filter,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)(x.Select,{value:W,onValueChange:Y,children:[(0,s.jsx)(x.SelectTrigger,{className:"w-[180px]",children:(0,s.jsx)(x.SelectValue,{placeholder:"Filter by crop"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"all",children:"All Crops"}),K.map(e=>(0,s.jsx)(x.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,s.jsx)(t.Tabs,{value:O,onValueChange:M,className:"w-auto",children:(0,s.jsxs)(t.TabsList,{children:[(0,s.jsx)(t.TabsTrigger,{value:"all",children:"All"}),(0,s.jsx)(t.TabsTrigger,{value:"issues",children:"With Issues"}),(0,s.jsx)(t.TabsTrigger,{value:"healthy",children:"Healthy Only"}),(0,s.jsx)(t.TabsTrigger,{value:"yellowing",children:"Yellowing Observed"})]})})]})]})})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold",children:["Growth & Tillering Records",(0,s.jsxs)("span",{className:"text-muted-foreground font-normal ml-2",children:["(",T.length," ",1===T.length?"record":"records",")"]})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sorted by latest date"})]}),0===T.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-12 text-center",children:[(0,s.jsx)(g.Sprout,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No growth & tillering data found"}),(0,s.jsx)("p",{className:"text-gray-500 max-w-sm mx-auto",children:$?"No records match your search criteria. Try different keywords.":"No growth & tillering data has been recorded yet."})]})}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map(e=>(0,s.jsx)(r.Card,{className:"group hover:shadow-lg transition-all duration-300 hover:border-primary/30 overflow-hidden",children:(0,s.jsxs)(r.CardContent,{className:"p-0",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-5",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 line-clamp-1",children:e.crop_name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Record #",e.id," ",e.farm&&`• Farm ${e.farm}`]})]}),(0,s.jsx)(n.Badge,{className:X(e.crop_health),children:e.crop_health})]})}),(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(S.Package,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"Fertilizer"})]}),(0,s.jsx)(n.Badge,{variant:"outline",className:"capitalize",children:e.fertilizer_type})]})}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(j.Leaf,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"Yellowing"})]}),(0,s.jsx)(n.Badge,{className:ee(e.yellowing_observed),children:e.yellowing_observed})]})})]}),"Yes"===e.yellowing_observed&&e.yellowing_bio_stimulant&&(0,s.jsxs)("div",{className:"mt-2 p-3 bg-red-50 rounded-lg border border-red-200",children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-red-800 mb-1 flex items-center gap-1",children:[(0,s.jsx)(C.AlertCircle,{className:"h-4 w-4"}),"Yellowing Treatment"]}),(0,s.jsx)("p",{className:"text-sm text-red-700",children:e.yellowing_bio_stimulant})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm font-medium text-gray-700 mb-2",children:"Bio Stimulant"}),(0,s.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:e.bio_stimulant_product}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Applied: ",e.bio_stimulant_applied]})]}),(0,s.jsx)(n.Badge,{className:es(e.bio_stimulant_applied),children:e.bio_stimulant_applied})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Weeds Present"}),et(e.weeds_present)]})}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Crop Height"}),(0,s.jsx)("span",{className:`font-bold ${J(e.crop_height)}`,children:Q(e.crop_height)})]})}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Zn Applied"}),ea(e.zn_applied)]})}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"2nd Irrigation"}),ea(e.fertilizers_applied_2nd_irrigation)]})})]}),(e.aphid_control||e.rust_management)&&(0,s.jsxs)("div",{className:"mt-4 p-3 bg-amber-50 rounded-lg border border-amber-200",children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-amber-800 mb-2 flex items-center gap-1",children:[(0,s.jsx)(B.Bug,{className:"h-4 w-4"}),"Pest Control"]}),(0,s.jsxs)("div",{className:"space-y-1",children:[e.aphid_control&&(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Aphid Control:"}),(0,s.jsx)("span",{className:"font-medium",children:e.aphid_control})]}),e.rust_management&&(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Rust Management:"}),(0,s.jsx)("span",{className:"font-medium",children:e.rust_management})]})]})]})]}),(0,s.jsxs)(l.Button,{onClick:()=>{F(e),z(!0)},variant:"outline",className:"w-full mt-4 gap-2 group-hover:border-primary",children:[(0,s.jsx)(f.Eye,{className:"h-4 w-4"}),"View Full Details",(0,s.jsx)(N.ChevronRight,{className:"h-4 w-4"})]})]}),(0,s.jsx)(r.CardFooter,{className:"border-t pt-4 flex justify-between text-sm text-gray-500",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(h.Calendar,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})})]})},e.id))})]}),(0,s.jsx)(m.Dialog,{open:D,onOpenChange:z,children:(0,s.jsx)(m.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:A?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.DialogHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(m.DialogTitle,{className:"text-2xl flex items-center gap-2",children:[(0,s.jsx)(g.Sprout,{className:"h-6 w-6 text-primary"}),A.crop_name," - Record #",A.id]}),(0,s.jsxs)(m.DialogDescription,{children:["Complete growth & tillering data"," ",A.farm&&`• Farm ${A.farm}`]})]}),(0,s.jsx)(n.Badge,{className:X(A.crop_health),children:A.crop_health})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(_.Wheat,{className:"h-5 w-5 text-green-600"}),"Crop Status"]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Crop Name"}),(0,s.jsx)("p",{className:"font-medium",children:A.crop_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Crop Health"}),(0,s.jsx)(n.Badge,{className:X(A.crop_health),children:A.crop_health})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Crop Height"}),(0,s.jsx)("p",{className:`font-bold ${J(A.crop_height)}`,children:Q(A.crop_height)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Yellowing Observed"}),(0,s.jsx)(n.Badge,{className:ee(A.yellowing_observed),children:A.yellowing_observed})]})]}),(0,s.jsx)(d.Separator,{}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Weeds Present"}),et(A.weeds_present)]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Post Emergent Applied"}),et(A.post_emergent_applied)]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(S.Package,{className:"h-5 w-5 text-amber-600"}),"Fertilizers & Stimulants"]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Fertilizer Type"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"font-medium capitalize",children:A.fertilizer_type}),(0,s.jsxs)(n.Badge,{variant:"outline",children:["2nd Irrigation:"," ",A.fertilizers_applied_2nd_irrigation]})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Zinc Application"}),(0,s.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"font-medium",children:A.zn_product}),(0,s.jsx)(n.Badge,{className:es(A.zn_applied),children:A.zn_applied})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Bio Stimulant"}),(0,s.jsx)("div",{className:"bg-green-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:A.bio_stimulant_product}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Applied: ",A.bio_stimulant_applied]}),"Yes"===A.yellowing_observed&&A.yellowing_bio_stimulant&&(0,s.jsxs)("div",{className:"mt-2 p-2 bg-red-100 rounded border border-red-200",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-red-700",children:"Yellowing Treatment:"}),(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:A.yellowing_bio_stimulant})]})]}),(0,s.jsx)(n.Badge,{className:es(A.bio_stimulant_applied),children:A.bio_stimulant_applied})]})})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(B.Bug,{className:"h-5 w-5 text-red-600"}),"Management & Control"]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Plant Growth Regulator"}),(0,s.jsx)("div",{className:"bg-purple-50 p-3 rounded-lg",children:(0,s.jsx)("p",{className:"font-medium",children:A.plant_growth_regulator})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Irrigation & Fertilizers"}),(0,s.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg",children:(0,s.jsx)("p",{className:"font-medium",children:A.irrigation_3rd_fertilizers})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Rust Management"}),(0,s.jsx)("div",{className:"bg-orange-50 p-3 rounded-lg",children:(0,s.jsx)("p",{className:"font-medium capitalize",children:A.rust_management})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Aphid Control"}),(0,s.jsx)("div",{className:"bg-red-50 p-3 rounded-lg",children:(0,s.jsx)("p",{className:"font-medium",children:A.aphid_control})})]})]})]})})]}),A.post_emergent_applied&&(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(C.AlertCircle,{className:"h-5 w-5 text-amber-600"}),"Post Emergent Details"]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Product"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsx)("p",{className:"font-medium",children:A.post_emergent_product||"Not specified"})})]}),A.post_emergent_other_text&&(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Additional Notes"}),(0,s.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg",children:(0,s.jsx)("p",{className:"text-gray-700",children:A.post_emergent_other_text})})]})]})})]}),(0,s.jsxs)(m.DialogFooter,{children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>z(!1),children:"Close"}),(0,s.jsx)(l.Button,{children:"Export Report"})]})]})]}):null})})]})}var D=e.i(10059),z=e.i(3496);function P(){let[e,o]=(0,a.useState)([]),[j,T]=(0,a.useState)([]),[L,A]=(0,a.useState)(null),[F,P]=(0,a.useState)(!1),[E,R]=(0,a.useState)(!0),[H,$]=(0,a.useState)(null),[I,W]=(0,a.useState)(""),[Y,O]=(0,a.useState)("all"),[M,V]=(0,a.useState)("all"),U=Array.from(new Set(e.map(e=>e.field_name))).sort((e,s)=>e.localeCompare(s)),G=e.length,q=e.filter(e=>"healthy"===e.crop_health).length,K=e.filter(e=>e.aphid_attack).length;e.filter(e=>e.crop_under_stress).length;let Z=e.filter(e=>e.weeds_observed).length;(0,a.useEffect)(()=>{X()},[]),(0,a.useEffect)(()=>{let s=[...e];if(""!==I.trim()){let e=I.toLowerCase();s=s.filter(s=>s.crop_name.toLowerCase().includes(e)||s.field_name.toLowerCase().includes(e)||s.fertilizer_type&&s.fertilizer_type.toLowerCase().includes(e)||s.crop_health.toLowerCase().includes(e))}"all"!==Y&&(s=s.filter(e=>e.field_name===Y)),"issues"===M?s=s.filter(e=>e.aphid_attack||e.crop_under_stress||e.weeds_observed):"healthy"===M?s=s.filter(e=>"healthy"===e.crop_health):"aphid"===M?s=s.filter(e=>e.aphid_attack):"stress"===M?s=s.filter(e=>e.crop_under_stress):"weeds"===M?s=s.filter(e=>e.weeds_observed):"fair"===M?s=s.filter(e=>"fair"===e.crop_health):"stressed"===M&&(s=s.filter(e=>"stressed"===e.crop_health)),T(s)},[I,Y,M,e]);let X=async()=>{try{R(!0);let e=localStorage.getItem("authToken");if(!e)return void $("No authentication token found");let s=await fetch("https://rda.ngrok.app/api/rosette-stage/",{headers:{Authorization:`Bearer ${e}`,"ngrok-skip-browser-warning":"true"}});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);let a=await s.json();console.log("Fetched rosette data:",a),o(a.results||[]),T(a.results||[])}catch(e){$(e instanceof Error?e.message:"Failed to fetch data"),console.error("Error fetching rosette data:",e)}finally{R(!1)}},J=e=>{switch(e.toLowerCase()){case"healthy":return"bg-green-100 text-green-800";case"fair":return"bg-yellow-100 text-yellow-800";case"stressed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Q=e=>{switch(e.toLowerCase()){case"healthy":return"Healthy";case"fair":return"Fair";case"stressed":return"Stressed";default:return e}},ee=e=>{switch(e.toLowerCase()){case"less_than_3_inches":return"< 3 inches";case"3_to_6_inches":return"3-6 inches";case"greater_than_6_inches":return"> 6 inches";default:return e.replace(/_/g," ")}},es=e=>{switch(e.toLowerCase()){case"greater_than_6_inches":return"text-green-600";case"3_to_6_inches":return"text-amber-600";case"less_than_3_inches":return"text-red-600";default:return"text-gray-600"}},ea=e=>(0,s.jsx)("div",{className:"flex items-center gap-1",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.CheckCircle,{className:"h-4 w-4 text-green-500"}),(0,s.jsx)("span",{className:"text-green-600 font-medium",children:"Yes"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p,{className:"h-4 w-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-gray-500",children:"No"})]})}),et=e=>e&&""!==e.trim();return E?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(k.Skeleton,{className:"h-10 w-48"}),(0,s.jsx)(k.Skeleton,{className:"h-4 w-64 mt-2"})]}),(0,s.jsx)(k.Skeleton,{className:"h-10 w-32"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,s.jsx)(k.Skeleton,{className:"h-32 rounded-lg"},e))}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,s.jsx)(k.Skeleton,{className:"h-64 rounded-lg"},e))})]}):H?(0,s.jsx)(r.Card,{children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center py-8 text-red-500",children:[(0,s.jsx)(C.AlertCircle,{className:"h-12 w-12 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:"Error Loading Data"}),(0,s.jsx)("p",{className:"text-sm mt-2",children:H}),(0,s.jsx)(l.Button,{onClick:X,className:"mt-4",children:"Retry"})]})})}):(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Rosette Stage Data"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Monitor crop health, fertilizer applications, and pest control by field"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(w.Download,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,s.jsxs)(l.Button,{size:"sm",onClick:X,children:[(0,s.jsx)(y.BarChart3,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-green-700",children:"Total Records"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-green-900 mt-2",children:G})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-green-200 flex items-center justify-center",children:(0,s.jsx)(_.Wheat,{className:"h-6 w-6 text-green-700"})})]})})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-700",children:"Healthy Crops"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-blue-900 mt-2",children:q})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-blue-200 flex items-center justify-center",children:(0,s.jsx)(u.CheckCircle,{className:"h-6 w-6 text-blue-700"})})]}),(0,s.jsxs)("p",{className:"text-xs text-blue-600 mt-2",children:[G>0?(q/G*100).toFixed(1):0,"% of total"]})]})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-red-700",children:"Aphid Attacks"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-red-900 mt-2",children:K})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-red-200 flex items-center justify-center",children:(0,s.jsx)(B.Bug,{className:"h-6 w-6 text-red-700"})})]})})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-amber-700",children:"Weeds Observed"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-amber-900 mt-2",children:Z})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-amber-200 flex items-center justify-center",children:(0,s.jsx)(C.AlertCircle,{className:"h-6 w-6 text-amber-700"})})]})})})]}),(0,s.jsx)(r.Card,{children:(0,s.jsx)(r.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[(0,s.jsx)("div",{className:"flex-1 w-full lg:w-auto",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(v.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,s.jsx)(i.Input,{placeholder:"Search by crop, fertilizer, health, or field number...",value:I,onChange:e=>W(e.target.value),className:"pl-10 w-full lg:w-[400px]"})]})}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(b.Filter,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)(x.Select,{value:Y,onValueChange:O,children:[(0,s.jsx)(x.SelectTrigger,{className:"w-[180px]",children:(0,s.jsx)(x.SelectValue,{placeholder:"Select Field"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"all",children:"All Fields"}),U.map(e=>(0,s.jsx)(x.SelectItem,{value:e,className:"capitalize",children:e},e))]})]})]}),(0,s.jsx)(t.Tabs,{value:M,onValueChange:V,className:"w-auto",children:(0,s.jsxs)(t.TabsList,{children:[(0,s.jsx)(t.TabsTrigger,{value:"all",children:"All"}),(0,s.jsx)(t.TabsTrigger,{value:"issues",children:"With Issues"}),(0,s.jsx)(t.TabsTrigger,{value:"healthy",children:"Healthy"}),(0,s.jsx)(t.TabsTrigger,{value:"fair",children:"Fair"}),(0,s.jsx)(t.TabsTrigger,{value:"stressed",children:"Stressed"}),(0,s.jsx)(t.TabsTrigger,{value:"aphid",children:"Aphid Attack"}),(0,s.jsx)(t.TabsTrigger,{value:"weeds",children:"Weeds"})]})})]})]})})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold",children:["Rosette Stage Records",(0,s.jsxs)("span",{className:"text-muted-foreground font-normal ml-2",children:["(",j.length," ",1===j.length?"record":"records",")"]})]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["all"!==Y&&(0,s.jsx)(n.Badge,{variant:"outline",className:"mr-2 capitalize",children:Y}),"Sorted by latest date"]})]}),0===j.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-12 text-center",children:[(0,s.jsx)(g.Sprout,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No rosette data found"}),(0,s.jsx)("p",{className:"text-gray-500 max-w-sm mx-auto",children:I?"No records match your search criteria. Try different keywords.":"all"!==Y?`No data found for ${Y}`:"No rosette stage data has been recorded yet."})]})}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(e=>(0,s.jsx)(r.Card,{className:"group hover:shadow-lg transition-all duration-300 hover:border-primary/30 overflow-hidden",children:(0,s.jsxs)(r.CardContent,{className:"p-0",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-5",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 line-clamp-1 capitalize",children:e.crop_name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Record #",e.id," • ",e.field_name]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,s.jsx)(n.Badge,{variant:"outline",className:"bg-white/90 capitalize",children:e.field_name}),(0,s.jsx)(n.Badge,{className:J(e.crop_health),children:Q(e.crop_health)})]})]})}),(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(z.Scale,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"Crop Height"})]}),(0,s.jsx)("span",{className:`font-bold ${es(e.crop_height)}`,children:ee(e.crop_height)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(S.Package,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"Fertilizer"})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("span",{className:"font-medium",children:e.fertilizer_type||"None"}),e.fertilizer_quantity_bags&&(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[e.fertilizer_quantity_bags," bags"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Weeds Observed"}),ea(e.weeds_observed)]})}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Aphid Attack"}),ea(e.aphid_attack)]})}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Crop Stress"}),ea(e.crop_under_stress)]})}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Fertilizers Applied"}),ea(e.fertilizers_applied)]})})]}),(0,s.jsxs)("div",{className:"mt-4 p-3 bg-amber-50 rounded-lg border border-amber-200",children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-amber-800 mb-2 flex items-center gap-1",children:[(0,s.jsx)(C.AlertCircle,{className:"h-4 w-4"}),"Key Recommendations"]}),(0,s.jsxs)("div",{className:"space-y-2",children:[et(e.recommendation_irrigation_fertilizers)&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 flex-shrink-0"}),(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("span",{className:"font-medium text-gray-700",children:"Fertilizer:"}),(0,s.jsx)("span",{className:"text-gray-600 ml-1",children:e.recommendation_irrigation_fertilizers})]})]}),et(e.recommendation_sulphur_kumulus)&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-yellow-500 flex-shrink-0"}),(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("span",{className:"font-medium text-gray-700",children:"Sulphur:"}),(0,s.jsx)("span",{className:"text-gray-600 ml-1",children:e.recommendation_sulphur_kumulus})]})]}),et(e.recommendation_white_rust)&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500 flex-shrink-0"}),(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("span",{className:"font-medium text-gray-700",children:"White Rust:"}),(0,s.jsx)("span",{className:"text-gray-600 ml-1",children:e.recommendation_white_rust})]})]}),et(e.recommendation_aphid_ulala)&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500 flex-shrink-0"}),(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("span",{className:"font-medium text-gray-700",children:"Aphid Control:"}),(0,s.jsx)("span",{className:"text-gray-600 ml-1",children:e.recommendation_aphid_ulala})]})]})]})]})]}),(0,s.jsxs)(l.Button,{onClick:()=>{A(e),P(!0)},variant:"outline",className:"w-full mt-4 gap-2 group-hover:border-primary",children:[(0,s.jsx)(f.Eye,{className:"h-4 w-4"}),"View Field Details",(0,s.jsx)(N.ChevronRight,{className:"h-4 w-4"})]})]}),(0,s.jsx)(r.CardFooter,{className:"border-t pt-4 flex justify-between text-sm text-gray-500",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(h.Calendar,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})})]})},e.id))})]}),(0,s.jsx)(m.Dialog,{open:F,onOpenChange:P,children:(0,s.jsx)(m.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:L&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.DialogHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(m.DialogTitle,{className:"text-2xl flex items-center gap-2",children:[(0,s.jsx)(_.Wheat,{className:"h-6 w-6 text-primary"}),L.crop_name," - ",L.field_name]}),(0,s.jsxs)(m.DialogDescription,{children:["Complete rosette stage data for ",L.field_name]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(n.Badge,{variant:"outline",children:[(0,s.jsx)(c.Label,{children:"Farm Name"}),(0,s.jsx)("p",{className:"font-bold capitalize",children:L.field_name})]}),(0,s.jsx)(n.Badge,{className:J(L.crop_health),children:Q(L.crop_health)})]})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(g.Sprout,{className:"h-5 w-5 text-green-600"}),"Crop Status"]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Field Number"}),(0,s.jsxs)("p",{className:"font-bold text-lg",children:["#",L.field]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Crop Height"}),(0,s.jsx)("p",{className:`font-bold text-lg ${es(L.crop_height)}`,children:ee(L.crop_height)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Crop Health"}),(0,s.jsx)(n.Badge,{className:J(L.crop_health),children:Q(L.crop_health)})]})]}),(0,s.jsx)(d.Separator,{}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Crop Under Stress"}),ea(L.crop_under_stress)]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Weeds Observed"}),ea(L.weeds_observed)]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Aphid Attack"}),ea(L.aphid_attack)]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(S.Package,{className:"h-5 w-5 text-amber-600"}),"Field Applications"]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Fertilizer"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg mt-1",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"font-medium",children:L.fertilizer_type||"None"}),L.fertilizer_quantity_bags&&(0,s.jsxs)(n.Badge,{variant:"outline",children:[L.fertilizer_quantity_bags," bags"]})]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Applied:"," ",L.fertilizers_applied?"Yes":"No"]})]})]}),L.post_emergent_applied&&(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Post Emergent"}),(0,s.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg mt-1",children:[(0,s.jsx)("p",{className:"font-medium",children:L.post_emergent_product}),L.post_emergent_other_text&&(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:L.post_emergent_other_text})]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(B.Bug,{className:"h-5 w-5 text-red-600"}),"Field Chemicals & Treatments"]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Sulphur Application"}),(0,s.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:L.sulphur_product||"None"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Applied:"," ",L.sulphur_applied?"Yes":"No"]})]}),L.sulphur_other_text&&(0,s.jsxs)(n.Badge,{variant:"outline",children:["Note: ",L.sulphur_other_text]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Amino Application"}),(0,s.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:L.amino_product||"None"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Applied:"," ",L.amino_applied?"Yes":"No"]})]}),L.amino_other_text&&(0,s.jsxs)(n.Badge,{variant:"outline",children:["Note: ",L.amino_other_text]})]})]}),L.aphid_attack&&(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Aphid Control"}),(0,s.jsxs)("div",{className:"bg-red-50 p-3 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"font-medium text-red-700",children:L.aphid_pesticide}),(0,s.jsx)(n.Badge,{variant:"destructive",children:"Urgent"})]}),L.aphid_other_text&&(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:L.aphid_other_text})]})]})]})})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(C.AlertCircle,{className:"h-5 w-5 text-blue-600"}),"Field Recommendations"]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:`p-3 rounded-lg ${et(L.recommendation_irrigation_fertilizers)?"bg-green-50 border border-green-200":"bg-gray-50"}`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)(S.Package,{className:`h-4 w-4 ${et(L.recommendation_irrigation_fertilizers)?"text-green-600":"text-gray-400"}`}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Fertilizer"})]}),(0,s.jsx)("p",{className:`text-sm ${et(L.recommendation_irrigation_fertilizers)?"text-green-700 font-medium":"text-gray-500"}`,children:L.recommendation_irrigation_fertilizers||"N/A"})]}),(0,s.jsxs)("div",{className:`p-3 rounded-lg ${et(L.recommendation_sulphur_kumulus)?"bg-yellow-50 border border-yellow-200":"bg-gray-50"}`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)(D.Thermometer,{className:`h-4 w-4 ${et(L.recommendation_sulphur_kumulus)?"text-yellow-600":"text-gray-400"}`}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Sulphur"})]}),(0,s.jsx)("p",{className:`text-sm ${et(L.recommendation_sulphur_kumulus)?"text-yellow-700 font-medium":"text-gray-500"}`,children:L.recommendation_sulphur_kumulus||"N/A"})]}),(0,s.jsxs)("div",{className:`p-3 rounded-lg ${et(L.recommendation_white_rust)?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)(C.AlertCircle,{className:`h-4 w-4 ${et(L.recommendation_white_rust)?"text-blue-600":"text-gray-400"}`}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"White Rust"})]}),(0,s.jsx)("p",{className:`text-sm ${et(L.recommendation_white_rust)?"text-blue-700 font-medium":"text-gray-500"}`,children:L.recommendation_white_rust||"N/A"})]}),(0,s.jsxs)("div",{className:`p-3 rounded-lg ${et(L.recommendation_aphid_ulala)?"bg-red-50 border border-red-200":"bg-gray-50"}`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)(B.Bug,{className:`h-4 w-4 ${et(L.recommendation_aphid_ulala)?"text-red-600":"text-gray-400"}`}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Aphid Control"})]}),(0,s.jsx)("p",{className:`text-sm ${et(L.recommendation_aphid_ulala)?"text-red-700 font-medium":"text-gray-500"}`,children:L.recommendation_aphid_ulala||"N/A"})]})]})})]}),(0,s.jsxs)(m.DialogFooter,{children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>P(!1),children:"Close"}),(0,s.jsx)(l.Button,{children:"Export Field Report"})]})]})]})})})]})}function E(){let[e,o]=(0,a.useState)([]),[h,g]=(0,a.useState)([]),[T,L]=(0,a.useState)(null),[A,F]=(0,a.useState)(!1),[D,z]=(0,a.useState)(!0),[P,E]=(0,a.useState)(null),[R,H]=(0,a.useState)(""),[$,I]=(0,a.useState)("all"),[W,Y]=(0,a.useState)("all"),O="https://rda.ngrok.app",M=e.length,V=e.filter(e=>"healthy"===e.crop_health).length,U=e.filter(e=>e.weeds_present).length,G=e.filter(e=>e.yellowing_cause&&e.yellowing_cause.length>0).length,q=Array.from(new Set(e.map(e=>e.farm_name)));(0,a.useEffect)(()=>{K()},[]),(0,a.useEffect)(()=>{let s=[...e];if(""!==R.trim()){let e=R.toLowerCase();s=s.filter(s=>s.crop_name.toLowerCase().includes(e)||s.crop_health.toLowerCase().includes(e)||s.weed_type.toLowerCase().includes(e))}"all"!==$&&(s=s.filter(e=>e.farm_name===$)),"issues"===W?s=s.filter(e=>e.yellowing_cause&&e.yellowing_cause.length>0||e.weeds_present):"healthy"===W?s=s.filter(e=>"healthy"===e.crop_health):"weeds"===W&&(s=s.filter(e=>e.weeds_present)),g(s)},[R,$,W,e]);let K=async()=>{try{z(!0);let e=localStorage.getItem("authToken");if(!e)return void E("No authentication token found");let s=await fetch("https://rda.ngrok.app/api/weed-monitoring/",{headers:{Authorization:`Bearer ${e}`,"ngrok-skip-browser-warning":"true"}});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);let a=await s.json();console.log("Fetched weed monitoring data:",a),o(a.results||[]),g(a.results||[])}catch(e){E(e instanceof Error?e.message:"Failed to fetch data"),console.error("Error fetching weed monitoring data:",e)}finally{z(!1)}},Z=e=>e?e.startsWith("http")?e:e.startsWith("/")?`${O}${e}`:`${O}/${e}`:null,X=e=>{switch(e.toLowerCase()){case"healthy":return"bg-green-100 text-green-800";case"fair":return"bg-yellow-100 text-yellow-800";case"stressed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},J=e=>{let s=parseInt(e.split("-")[0]);return s<10?"text-green-600":s<30?"text-amber-600":"text-red-600"},Q=e=>e.map((e,a)=>{let t="bg-gray-100 text-gray-800",r=e.replace("_"," ");switch(e){case"nutrient_deficiency":t="bg-red-100 text-red-800",r="Nutrient Deficiency";break;case"water_stress":t="bg-blue-100 text-blue-800",r="Water Stress";break;case"disease":t="bg-purple-100 text-purple-800",r="Disease";break;case"pest_damage":t="bg-orange-100 text-orange-800",r="Pest Damage"}return(0,s.jsx)(n.Badge,{className:`text-xs ${t}`,children:r},a)}),ee=e=>(0,s.jsx)("div",{className:"flex items-center gap-1",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.CheckCircle,{className:"h-4 w-4 text-green-500"}),(0,s.jsx)("span",{className:"text-green-600 font-medium",children:"Yes"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p,{className:"h-4 w-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-gray-500",children:"No"})]})});return D?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(k.Skeleton,{className:"h-10 w-48"}),(0,s.jsx)(k.Skeleton,{className:"h-4 w-64 mt-2"})]}),(0,s.jsx)(k.Skeleton,{className:"h-10 w-32"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,s.jsx)(k.Skeleton,{className:"h-32 rounded-lg"},e))}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,s.jsx)(k.Skeleton,{className:"h-64 rounded-lg"},e))})]}):P?(0,s.jsx)(r.Card,{children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center py-8 text-red-500",children:[(0,s.jsx)(C.AlertCircle,{className:"h-12 w-12 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:"Error Loading Data"}),(0,s.jsx)("p",{className:"text-sm mt-2",children:P}),(0,s.jsx)(l.Button,{onClick:K,className:"mt-4",children:"Retry"})]})})}):(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Weed Monitoring & Crop Health"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Monitor weed presence, crop health issues, and yellowing causes"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(w.Download,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,s.jsxs)(l.Button,{size:"sm",onClick:K,children:[(0,s.jsx)(y.BarChart3,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-green-700",children:"Total Records"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-green-900 mt-2",children:M})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-green-200 flex items-center justify-center",children:(0,s.jsx)(j.Leaf,{className:"h-6 w-6 text-green-700"})})]})})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:(0,s.jsxs)(r.CardContent,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-700",children:"Healthy Crops"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-blue-900 mt-2",children:V})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-blue-200 flex items-center justify-center",children:(0,s.jsx)(u.CheckCircle,{className:"h-6 w-6 text-blue-700"})})]}),(0,s.jsxs)("p",{className:"text-xs text-blue-600 mt-2",children:[M>0?(V/M*100).toFixed(1):0,"% of total"]})]})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-red-700",children:"Weeds Present"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-red-900 mt-2",children:U})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-red-200 flex items-center justify-center",children:(0,s.jsx)(B.Bug,{className:"h-6 w-6 text-red-700"})})]})})}),(0,s.jsx)(r.Card,{className:"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-amber-700",children:"Yellowing Issues"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-amber-900 mt-2",children:G})]}),(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-amber-200 flex items-center justify-center",children:(0,s.jsx)(C.AlertCircle,{className:"h-6 w-6 text-amber-700"})})]})})})]}),(0,s.jsx)(r.Card,{children:(0,s.jsx)(r.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[(0,s.jsx)("div",{className:"flex-1 w-full lg:w-auto",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(v.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,s.jsx)(i.Input,{placeholder:"Search by crop name, health status, or weed type...",value:R,onChange:e=>H(e.target.value),className:"pl-10 w-full lg:w-[400px]"})]})}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(b.Filter,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)(x.Select,{value:$,onValueChange:I,children:[(0,s.jsx)(x.SelectTrigger,{className:"w-[180px]",children:(0,s.jsx)(x.SelectValue,{placeholder:"Filter by field"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"all",children:"All Fields"}),q.map(e=>(0,s.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]}),(0,s.jsx)(t.Tabs,{value:W,onValueChange:Y,className:"w-auto",children:(0,s.jsxs)(t.TabsList,{children:[(0,s.jsx)(t.TabsTrigger,{value:"all",children:"All"}),(0,s.jsx)(t.TabsTrigger,{value:"issues",children:"With Issues"}),(0,s.jsx)(t.TabsTrigger,{value:"healthy",children:"Healthy Only"}),(0,s.jsx)(t.TabsTrigger,{value:"weeds",children:"Weeds Present"})]})})]})]})})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold",children:["Weed Monitoring Records",(0,s.jsxs)("span",{className:"text-muted-foreground font-normal ml-2",children:["(",h.length," ",1===h.length?"record":"records",")"]})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sorted by latest date"})]}),0===h.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-12 text-center",children:[(0,s.jsx)(j.Leaf,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No weed monitoring data found"}),(0,s.jsx)("p",{className:"text-gray-500 max-w-sm mx-auto",children:R?"No records match your search criteria. Try different keywords.":"No weed monitoring data has been recorded yet."})]})}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(e=>{let a=Z(e.weed_photo);return(0,s.jsx)(r.Card,{className:"group hover:shadow-lg transition-all duration-300 hover:border-primary/30 overflow-hidden",children:(0,s.jsxs)(r.CardContent,{className:"p-0",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-5",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 line-clamp-1 capitalize",children:e.crop_name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Record #",e.id," • ",e.farm_name]})]}),(0,s.jsx)(n.Badge,{className:X(e.crop_health),children:e.crop_health})]})}),(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[e.yellowing_cause&&e.yellowing_cause.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm font-medium text-gray-700 mb-2",children:"Yellowing Causes"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:Q(e.yellowing_cause)})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(j.Leaf,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"Weed Presence"})]}),ee(e.weeds_present)]}),e.weeds_present&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Weed Type"}),(0,s.jsx)(n.Badge,{variant:"outline",className:"capitalize",children:e.weed_type})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Cover Percentage"}),(0,s.jsx)("span",{className:`font-bold ${J(e.weed_cover_percentage)}`,children:e.weed_cover_percentage_display})]})]})]}),e.post_emergent_weedicide_applied&&(0,s.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-blue-800 mb-1 flex items-center gap-1",children:[(0,s.jsx)(S.Package,{className:"h-4 w-4"}),"Weedicide Applied"]}),(0,s.jsx)("p",{className:"text-sm",children:e.weedicide_product})]}),a&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)(c.Label,{className:"text-sm font-medium text-gray-700 mb-2",children:"Weed Photo"}),(0,s.jsx)("div",{className:"relative h-32 rounded-lg overflow-hidden bg-gray-100",children:(0,s.jsx)("img",{src:a,alt:`Weed photo for ${e.crop_name}`,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.style.display="none",e.currentTarget.parentElement.innerHTML=`
                          <div class="w-full h-full flex flex-col items-center justify-center">
                            <ImageIcon class="h-8 w-8 text-gray-300 mb-2" />
                            <p class="text-xs text-gray-400">Image unavailable</p>
                          </div>
                        `}})})]})]}),(0,s.jsxs)(l.Button,{onClick:()=>{L(e),F(!0)},variant:"outline",className:"w-full mt-4 gap-2 group-hover:border-primary",children:[(0,s.jsx)(f.Eye,{className:"h-4 w-4"}),"View Full Details",(0,s.jsx)(N.ChevronRight,{className:"h-4 w-4"})]})]}),(0,s.jsx)(r.CardFooter,{className:"border-t pt-4 flex justify-between text-sm text-gray-500",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"}),(0,s.jsx)("span",{children:e.farm_name})]})})]})},e.id)})})]}),(0,s.jsx)(m.Dialog,{open:A,onOpenChange:F,children:(0,s.jsx)(m.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:(()=>{if(!T)return null;let e=Z(T.weed_photo);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.DialogHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(m.DialogTitle,{className:"text-2xl flex items-center gap-2",children:[(0,s.jsx)(_.Wheat,{className:"h-6 w-6 text-primary"}),T.crop_name," — ",T.farm_name]}),(0,s.jsxs)(m.DialogDescription,{children:["Complete weed monitoring data • ",T.farm_name]})]}),(0,s.jsx)(n.Badge,{className:X(T.crop_health),children:T.crop_health})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(u.CheckCircle,{className:"h-5 w-5 text-green-600"}),"Crop Status"]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Crop Name"}),(0,s.jsx)("p",{className:"font-medium capitalize",children:T.crop_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"text-sm text-muted-foreground",children:"Crop Health"}),(0,s.jsx)(n.Badge,{className:X(T.crop_health),children:T.crop_health})]})]}),(0,s.jsx)(d.Separator,{}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Weeds Present"}),ee(T.weeds_present)]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Leave Observations"}),ee(T.leave_observations)]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(C.AlertCircle,{className:"h-5 w-5 text-amber-600"}),"Yellowing Issues"]})}),(0,s.jsx)(r.CardContent,{children:T.yellowing_cause.length>0?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Main Causes"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:Q(T.yellowing_cause)})]}),(T.yellowing_sub_cause.water_stress?.length>0||T.yellowing_sub_cause.nutrient_deficiency?.length>0)&&(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Specific Issues"}),(0,s.jsxs)("div",{className:"space-y-2",children:[T.yellowing_sub_cause.water_stress?.map((e,a)=>(0,s.jsxs)("div",{className:"flex items-start gap-2 bg-blue-50 p-2 rounded",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500 mt-2 flex-shrink-0"}),(0,s.jsxs)("span",{className:"text-sm",children:["Water Stress: ",e]})]},a)),T.yellowing_sub_cause.nutrient_deficiency?.map((e,a)=>(0,s.jsxs)("div",{className:"flex items-start gap-2 bg-red-50 p-2 rounded",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500 mt-2 flex-shrink-0"}),(0,s.jsxs)("span",{className:"text-sm",children:["Nutrient Deficiency: ",e]})]},a))]})]})]}):(0,s.jsx)("div",{className:"text-center py-4 text-gray-500",children:"No yellowing issues reported"})})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(B.Bug,{className:"h-5 w-5 text-red-600"}),"Weed Details"]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Weed Type"}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,s.jsx)("span",{className:"font-medium capitalize",children:T.weed_type})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Weed Cover"}),(0,s.jsx)("div",{className:`p-3 rounded-lg font-bold text-lg text-center ${J(T.weed_cover_percentage)}`,children:T.weed_cover_percentage_display})]})]}),e&&(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Weed Photo"}),(0,s.jsx)("div",{className:"rounded-lg overflow-hidden border",children:(0,s.jsx)("img",{src:e,alt:`Weed photo for ${T.crop_name}`,className:"w-full h-48 object-cover",onError:e=>{e.currentTarget.style.display="none",e.currentTarget.parentElement.innerHTML=`
                              <div class="w-full h-48 flex flex-col items-center justify-center bg-gray-100">
                                <ImageIcon class="h-12 w-12 text-gray-300 mb-2" />
                                <p class="text-sm text-gray-400">Image not available</p>
                              </div>
                            `}})})]})]}),T.post_emergent_weedicide_applied&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)(c.Label,{className:"font-medium text-gray-700 mb-2",children:"Weedicide Application"}),(0,s.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"Product Applied"}),(0,s.jsx)("p",{className:"text-lg font-bold text-blue-700",children:T.weedicide_product})]}),(0,s.jsx)(n.Badge,{variant:"default",children:"Applied"})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Post-emergent weedicide:"," ",T.post_emergent_weedicide_applied]})]})]})]})})]}),T.other_issues_text&&(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(C.AlertCircle,{className:"h-5 w-5 text-purple-600"}),"Other Issues & Notes"]})}),(0,s.jsx)(r.CardContent,{children:(0,s.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,s.jsx)("p",{className:"text-gray-700",children:T.other_issues_text})})})]}),(0,s.jsxs)(m.DialogFooter,{children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>F(!1),children:"Close"}),(0,s.jsx)(l.Button,{children:"Export Report"})]})]})]})})()})})]})}function R(){let[e,r]=(0,a.useState)("pre-sowing");return(0,s.jsxs)(t.Tabs,{value:e,onValueChange:r,className:"w-full",children:[(0,s.jsxs)(t.TabsList,{className:"grid w-full grid-cols-2 lg:grid-cols-5 mb-6",children:[(0,s.jsx)(t.TabsTrigger,{value:"pre-sowing",children:"Pre-Sowing"}),(0,s.jsx)(t.TabsTrigger,{value:"sowing",children:"Sowing & Emergence"}),(0,s.jsx)(t.TabsTrigger,{value:"emergence",children:"Emergence"}),(0,s.jsx)(t.TabsTrigger,{value:"growth",children:"Growth & Tillering"}),(0,s.jsx)(t.TabsTrigger,{value:"rosette",children:"Rosette Stage"})]}),(0,s.jsx)(t.TabsContent,{value:"pre-sowing",children:(0,s.jsx)(L,{})}),(0,s.jsx)(t.TabsContent,{value:"sowing",children:(0,s.jsx)(A,{})}),(0,s.jsx)(t.TabsContent,{value:"emergence",children:(0,s.jsx)(E,{})}),(0,s.jsx)(t.TabsContent,{value:"growth",children:(0,s.jsx)(F,{})}),(0,s.jsx)(t.TabsContent,{value:"rosette",children:(0,s.jsx)(P,{})})]})}e.s(["StagesContainer",()=>R],72905)}]);