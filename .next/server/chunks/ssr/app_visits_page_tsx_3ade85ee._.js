module.exports=[39993,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(64756),e=a.i(69265),f=a.i(5522),g=a.i(40695),h=a.i(65733),i=a.i(3130),j=a.i(54161),k=a.i(21958),l=a.i(41675),m=a.i(41710),n=a.i(24987),o=a.i(46842),p=a.i(70047),q=a.i(50522),r=a.i(87532),s=a.i(81464),t=a.i(84505);let u=(0,a.i(70106).default)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);var v=a.i(47341),w=a.i(39761),x=a.i(77156),y=a.i(33508),z=a.i(38632),A=a.i(92e3),B=a.i(7379);function C(){let[a,C]=(0,c.useState)([]),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)("newest"),[L,M]=(0,c.useState)(!0),[N,O]=(0,c.useState)("all"),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(null),T=async()=>{try{M(!0);let a=localStorage.getItem("authToken"),b=await fetch("https://rda.ngrok.app/api/visits/",{method:"GET",headers:{Authorization:`Bearer ${a}`,"ngrok-skip-browser-warning":"true"}});if(!b.ok)throw Error(`HTTP ${b.status}`);let c=await b.text(),d=b.headers.get("content-type")||"";if(!d.includes("application/json"))throw Error(`Expected JSON but got: ${d}`);let e=JSON.parse(c);console.log(e),e.results?(C(e.results),E(e.results)):(console.warn('No "results" key in response'),C([]),E([]))}catch(a){console.error("Error fetching visits:",a),C([]),E([])}finally{M(!1)}};(0,c.useEffect)(()=>{T()},[]),(0,c.useEffect)(()=>{let b=[...a];if("all"!==N&&(b=b.filter(a=>{if("recent"===N){let b=new Date(a.visit_date);return 7>=Math.ceil(Math.abs(new Date().getTime()-b.getTime())/864e5)}return"withPhotos"!==N||a.photos?.length>0})),""!==H.trim()){let a=H.toLowerCase();b=b.filter(b=>`${b.farmer_name} ${b.field_name} ${b.crop} ${b.crop_stage_display}`.toLowerCase().includes(a))}b.sort((a,b)=>"newest"===J?new Date(b.visit_date).getTime()-new Date(a.visit_date).getTime():new Date(a.visit_date).getTime()-new Date(b.visit_date).getTime()),E(b)},[H,J,a,N]);let U=a=>new Date(a).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),V=a=>({planting:"bg-blue-100 text-blue-800",vegetative:"bg-green-100 text-green-800",flowering:"bg-purple-100 text-purple-800",harvesting:"bg-amber-100 text-amber-800","post-harvest":"bg-gray-100 text-gray-800"})[a.toLowerCase()]||"bg-gray-100 text-gray-800";return(0,b.jsxs)("div",{className:"flex h-screen bg-background",children:[(0,b.jsx)(d.Sidebar,{}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,b.jsx)(e.DashboardHeader,{}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Field Visits"}),(0,b.jsx)("p",{className:"text-gray-600 mt-2",children:"Track and monitor all farm officer activities and field inspections"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(g.Button,{variant:"outline",className:"gap-2",children:[(0,b.jsx)(t.Download,{className:"h-4 w-4"}),"Export"]}),(0,b.jsxs)(g.Button,{onClick:T,className:"gap-2",children:[(0,b.jsx)(u,{className:"h-4 w-4"}),"Refresh"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsx)(i.Card,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:(0,b.jsx)(i.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-blue-700",children:"Total Visits"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-blue-900 mt-2",children:a.length})]}),(0,b.jsx)(w.BarChart3,{className:"h-10 w-10 text-blue-600"})]})})}),(0,b.jsx)(i.Card,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:(0,b.jsx)(i.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-green-700",children:"Farmers Visited"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-green-900 mt-2",children:[...new Set(a.map(a=>a.farmer_name))].length})]}),(0,b.jsx)(o.User,{className:"h-10 w-10 text-green-600"})]})})}),(0,b.jsx)(i.Card,{className:"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200",children:(0,b.jsx)(i.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-amber-700",children:"Photos Taken"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-amber-900 mt-2",children:a.reduce((a,b)=>a+(b.photos?.length||0),0)})]}),(0,b.jsx)(z.Image,{className:"h-10 w-10 text-amber-600"})]})})})]}),(0,b.jsx)(i.Card,{className:"border shadow-sm",children:(0,b.jsx)(i.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[(0,b.jsx)("div",{className:"flex-1 w-full lg:w-auto",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(r.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,b.jsx)(f.Input,{placeholder:"Search visits by farmer, field, crop, or stage...",value:H,onChange:a=>I(a.target.value),className:"pl-10 w-full lg:w-[400px]"})]})}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,b.jsx)(k.Tabs,{defaultValue:"all",className:"w-full lg:w-auto",onValueChange:O,children:(0,b.jsxs)(k.TabsList,{children:[(0,b.jsx)(k.TabsTrigger,{value:"all",children:"All Visits"}),(0,b.jsx)(k.TabsTrigger,{value:"recent",children:"Recent"}),(0,b.jsx)(k.TabsTrigger,{value:"withPhotos",children:"With Photos"})]})}),(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>K("newest"===J?"oldest":"newest"),className:"gap-2",children:[(0,b.jsx)(s.Filter,{className:"h-4 w-4"}),"newest"===J?"Newest First":"Oldest First"]})]})]})})}),L&&(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,b.jsx)("p",{className:"text-gray-600 mt-4",children:"Loading field visits..."})]})}),!L&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-800",children:[D.length," ",1===D.length?"Visit":"Visits"," Found"]}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:["Sorted by ","newest"===J?"most recent":"oldest first"]})]}),0===D.length?(0,b.jsx)(i.Card,{className:"border-dashed",children:(0,b.jsxs)(i.CardContent,{className:"p-12 text-center",children:[(0,b.jsx)(A.AlertCircle,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No visits found"}),(0,b.jsx)("p",{className:"text-gray-500",children:H?"Try adjusting your search terms":"No field visits have been recorded yet"})]})}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map(a=>(0,b.jsx)(i.Card,{className:"group cursor-pointer hover:shadow-lg transition-all duration-300 hover:border-primary/30 overflow-hidden",onClick:()=>G(a),children:(0,b.jsxs)(i.CardContent,{className:"p-0",children:[(0,b.jsxs)("div",{className:"relative h-48 overflow-hidden bg-gray-100",children:[a.photos?.length>0?(0,b.jsx)("img",{src:a.photos[0],alt:a.field_name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200",children:(0,b.jsx)(z.Image,{className:"h-12 w-12 text-gray-400"})}),(0,b.jsxs)(j.Badge,{className:"absolute top-3 right-3 bg-white/90 text-gray-800 hover:bg-white",children:[a.photos?.length||0," photos"]})]}),(0,b.jsxs)("div",{className:"p-5",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,b.jsx)(j.Badge,{className:V(a.crop_stage),children:a.crop_stage_display}),(0,b.jsx)("span",{className:"text-xs text-gray-500 font-medium",children:U(a.visit_date)})]}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-1",children:a.farmer_name}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:a.field_name}),(0,b.jsx)(B.Separator,{className:"my-4"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,b.jsx)(v.Crop,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,b.jsx)("span",{className:"font-medium",children:"Crop:"}),(0,b.jsx)("span",{className:"ml-2",children:a.crop})]}),(0,b.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,b.jsx)(o.User,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,b.jsx)("span",{className:"font-medium",children:"Officer:"}),(0,b.jsx)("span",{className:"ml-2 line-clamp-1",children:a.conducted_by_name})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-3",children:[(0,b.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,b.jsx)(m.Clock,{className:"h-3 w-3 mr-1"}),a.visit_time]}),(0,b.jsxs)(g.Button,{variant:"ghost",size:"sm",className:"gap-1 text-primary",children:["View Details",(0,b.jsx)(q.ChevronRight,{className:"h-4 w-4"})]})]})]})]})]})},a.id))})]})]})})]}),(0,b.jsx)(h.Dialog,{open:!!F,onOpenChange:()=>G(null),children:(0,b.jsx)(h.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:F&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(h.DialogTitle,{className:"text-2xl",children:"Visit Details"}),(0,b.jsx)(g.Button,{variant:"ghost",size:"sm",onClick:()=>G(null),className:"h-8 w-8 p-0",children:(0,b.jsx)(y.X,{className:"h-4 w-4"})})]}),(0,b.jsx)(h.DialogDescription,{children:"Complete field visit information"})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:F.farmer_name}),(0,b.jsx)("p",{className:"text-gray-700",children:F.field_name})]}),(0,b.jsx)(j.Badge,{className:`text-sm px-3 py-1 ${V(F.crop_stage)}`,children:F.crop_stage_display})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)(i.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(l.Calendar,{className:"h-5 w-5 text-blue-600"}),"Visit Information"]})}),(0,b.jsx)(i.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Date:"}),(0,b.jsx)("span",{className:"font-medium",children:U(F.visit_date)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Time:"}),(0,b.jsx)("span",{className:"font-medium",children:F.visit_time})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Conducted By:"}),(0,b.jsx)("span",{className:"font-medium text-right",children:F.conducted_by_name})]})]})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)(i.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(p.Leaf,{className:"h-5 w-5 text-green-600"}),"Crop Details"]})}),(0,b.jsx)(i.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Crop Type:"}),(0,b.jsx)("span",{className:"font-medium",children:F.crop})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Growth Stage:"}),(0,b.jsx)("span",{className:"font-medium",children:F.crop_stage_display})]}),F.latitude&&F.longitude&&(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Location:"}),(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>{S({latitude:F.latitude,longitude:F.longitude,name:`${F.field_name}`,cropName:F.crop,farmerName:F.farmer_name}),Q(!0)},children:[(0,b.jsx)(n.MapPin,{className:"h-4 w-4"}),"View Map"]})]})]})})]})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)(i.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(z.Image,{className:"h-5 w-5 text-amber-600"}),"Field Photos (",F.photos?.length||0,")"]})}),(0,b.jsx)(i.CardContent,{children:F.photos?.length>0?(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:F.photos.map((a,c)=>(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("img",{src:a,alt:`Field photo ${c+1}`,className:"w-full h-48 object-cover rounded-lg"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center",children:(0,b.jsx)(x.Eye,{className:"h-8 w-8 text-white"})})]},c))}):(0,b.jsxs)("div",{className:"text-center py-8 border-2 border-dashed rounded-lg",children:[(0,b.jsx)(z.Image,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-gray-500",children:"No photos were taken during this visit"})]})})]}),(0,b.jsxs)(h.DialogFooter,{className:"gap-2",children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>G(null),children:"Close"}),(0,b.jsxs)(g.Button,{className:"gap-2",children:[(0,b.jsx)(t.Download,{className:"h-4 w-4"}),"Export Report"]})]})]})]})})})]})}a.s(["default",()=>C],39993)}];

//# sourceMappingURL=app_visits_page_tsx_3ade85ee._.js.map